凌晨3:08 我开始了task2的学习。

学习内容：DNS协议

资料来源：博客园《DNS协议详解》
内容记录：
  DNS：Domain Name System 
  用于TCP/IP网络，把域名解析为IP地址，将IP地址解析为域名。
  （域名空间结构）https://img2022.cnblogs.com/blog/807634/202205/807634-20220509221749565-289969285.png
  （递归查询和迭代查询）https://img2022.cnblogs.com/blog/807634/202205/807634-20220509223407558-1592939177.png
想法记录：这样的查询方式好复杂，我要看看为什么这么设计，是安全起见吗，还是便于管理？

资料来源：RFC-1034（DNS的内容和基础）
想法记录：
  *玩家 Phauusthite 获得了 文档*1 ！
  *玩家 Phauusthite 的英语水平提升了 1 点！
  *玩家 Phauusthite 的HP值下降了 100 点！
  *玩家 Phauusthite 掉线了！
  *Error:Failed to send the message"我要洋人死"！Please check your network connection!
内容记录：
  1.定位
  域名系统（DNS）的函数和数据类型的集合构成了一份完整的官方协议，包含标准的查询及响应，
  以及大部分的互联网类数据格式（如 主机地址）。
  标准官方协议之外的，试验性或过时的用法应当谨慎运用。
  用例仅供教学，不建议完全依赖。
  2.内容介绍
  该备忘录介绍域名、域名在互联网邮件和主机地址服务支持中的应用，以及用于实现域名系统的协议和服务器。
    2.1域名的历史
    大致是主机数量的爆炸式增长催生了分层管理名称空间的思想
    （分布式数据库：用计算机网络将物理上分散的多个数据库单元连接起来组成的一个逻辑上统一的数据库）
    2.2设计目的
    a.命名方式统一且不含特殊编码
    b.以分布式方式进行维护，并使用本地缓存提高性能（获得整个数据库的副本花销太大并且没必要）
    c.源数据应权衡三个要素：获取数据的成本、更新速度、缓存的准确性。
    d.支持在不同的网络协议之间进行转换并支持多种数据格式，以便适应不同的应用场景和需求。
    e.支持多种网络传输方式，以适应不同的网络环境和需求。
    f.支持不同类型的主机运行。
    2.3 DNS应用预设
    a.初始时，域名系统中的总数据库大小将与使用系统的主机数量成正比，
    但随着邮箱等其他信息添加到域名系统中，总数据库大小将最终与使用这些主机的用户数量成正比增长。
    b.存储数据相对固定，但对于数据修改操作的响应应当快速。
    c.
看晕了，歇会。。
DNS协议的作用应该就在这了：作为域名和IP地址相互映射的一个分布式数据库,能够让用户输入可读性强的网址来访问网站，而不用输入机器读取的ip数串，那对人来说太不友好了。

资料来源：RFC-1035（DNS的实现和细节说明）
学习记录：
  不翻了，累。。
  DNS查询流程：
                 Local Host                        |  Foreign
                                                   |
    +---------+               +----------+         |  +--------+
    |         | user queries  |          |queries  |  |        |
    |  User   |-------------->|          |---------|->|Foreign |
    | Program |               | Resolver |         |  |  Name  |
    |         |<--------------|          |<--------|--| Server |
    |         | user responses|          |responses|  |        |
    +---------+               +----------+         |  +--------+
                                |     A            |
                cache additions |     | references |
                                V     |            |
                              +----------+         |
                              |  Shared  |         |
                              | database |         |
                              +----------+         |
                                A     |            |
      +---------+     refreshes |     | references |
     /         /|               |     V            |
    +---------+ |             +----------+         |  +--------+
    |         | |             |          |responses|  |        |
    |         | |             |   Name   |---------|->|Foreign |
    |  Master |-------------->|  Server  |         |  |Resolver|
    |  files  | |             |          |<--------|--|        |
    |         |/              |          | queries |  +--------+
    +---------+               +----------+         |
                                A     |maintenance |  +--------+
                                |     +------------|->|        |
                                |      queries     |  |Foreign |
                                |                  |  |  Name  |
                                +------------------|--| Server |
                             maintenance responses |  +--------+
  
  a.域名系统用户端检索模式：
  用户程序向解析器发送检索请求，解析器接收请求后先在缓存中查询，若缓存内有请求的数据则直接取出并返回给用户，
  若缓存内没有，解析器就向外域名服务器发送检索请求，得到响应后转发给用户。
  b.域名系统服务端响应模式：
  服务器读取本地主文件来获取回复内容。
  c.多台服务器冗余支持：
  辅助服务器使用DNS传输协议从主服务器获取副本并检查更新。
  
  共享数据库所储存的内容由域服务器储存的定期更新的权威性数据和用户解析器所缓存的历史数据两部分组成。

                   Local Hosts                     |  Foreign
                                                   |
    +---------+                                    |
    |         | responses                          |
    | Stub    |<--------------------+              |
    | Resolver|                     |              |
    |         |----------------+    |              |
    +---------+ recursive      |    |              |
                queries        |    |              |
                               V    |              |
    +---------+ recursive     +----------+         |  +--------+
    |         | queries       |          |queries  |  |        |
    | Stub    |-------------->| Recursive|---------|->|Foreign |
    | Resolver|               | Server   |         |  |  Name  |
    |         |<--------------|          |<--------|--| Server |
    +---------+ responses     |          |responses|  |        |
                              +----------+         |  +--------+
                              |  Central |         |
                              |   cache  |         |
                              +----------+         |
     名称解析器              递归查找

//这里我不是很清楚就查了别的资料，插入一下来自Cloudflare的《DNS服务器有哪些不同类型？》
 （很好的图！）https://www.cloudflare-cn.com/img/learning/dns/dns-server-types/recursive-resolver.png
  想法：根服务器真的好累。。and好像又发现一个学习的好地方！码住了
  Cloudflare：https://www.cloudflare-cn.com/
  噢，好像DNS服务器的分类与作用顺便学完了，ok吧✌

最后要学习的是DNS报文格式、各标志位的含义。
  //官方文档有点太长了，我搜了点别的：来自CSDN的博客（虽然也是转载的，懒得管了）（类似于翻译总结的地位）《【转】DNS协议报文(RFC1035)》
  1.报文格式（Format）
    +---------------------+
    |        Header       | 报文头
    +---------------------+
    |       Question      | 查询的问题
    +---------------------+
    |        Answer       | 应答
    +---------------------+
    |      Authority      | 授权应答
    +---------------------+
    |      Additional     | 附加信息
    +---------------------+
  //（copy过来出现了提示“请标明原创出处”）你妈的，你标题都写了【转】，并且还是二转，你标什么原创啊..要说出处也应该是RFC1035啊!
     昨天还看见一个，把人家免费的github开源挂上去卖，神经病
  //回到RFC1035啦
  A.Header:
                                    1  1  1  1  1  1
      0  1  2  3  4  5  6  7  8  9  0  1  2  3  4  5
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    |                      ID                       |
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    |QR|   Opcode  |AA|TC|RD|RA|   Z    |   RCODE   |
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    |                    QDCOUNT                    |---->问题条目数
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    |                    ANCOUNT                    |---->应答记录数
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    |                    NSCOUNT                    |---->授权应答记录数
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    |                    ARCOUNT                    |---->附加记录数
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
  QR:Question or Answer?
  Opcode:kind of query
  AA:Authoritative Answer
  TC:Trun Caution(length)
  RD:(optional)Recursion Desired
  RA:Recursion Desired
  Z:Resrved🤣
  RCODE:Response!<----除了这个其他都是标志/声明
  B.Question
                                    1  1  1  1  1  1
      0  1  2  3  4  5  6  7  8  9  0  1  2  3  4  5
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    |                                               |
    /                     QNAME                     /---->域名
    /                                               /
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    |                     QTYPE                     |---->查询类型
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    |                     QCLASS                    |---->查询协议类//很好懂啦
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
  //找到一篇更全的博客,也是CSDN上的,《【转】DNS协议报文(RFC1035)》.名字都一样啊?好吧...
  //我的标点符号怎么变不回去了??
  C.Resource record format (The answer, authority, and additional sections all share the same format)  
                                    1  1  1  1  1  1
      0  1  2  3  4  5  6  7  8  9  0  1  2  3  4  5
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    |                                               |
    /                                               /
    /                      NAME                     /---->相关域名
    |                                               |
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    |                      TYPE                     |---->RR类型
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    |                     CLASS                     |---->RDATA类
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    |                      TTL                      |---->RR可被缓存的时间
    |                                               |
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
    |                   RDLENGTH                    |---->RDATA长度
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--|
    /                     RDATA                     /---->内容啦
    /                                               /
    +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+

  2.报文压缩
  //转的什么屁缩进跟被狗啃了一样,还是官方文档香
  哦哦哦用指针和偏移值,好巧妙,指针真是好东西!(缩的域名)

  3.因特网中DNS支持端口53的TCP[RFC-793]和端口53的UDP [RFC-768]传输。

  //Task2基本完成!接下来是Task3!下篇见!
  //噢对,现在是18号凌晨3:02!